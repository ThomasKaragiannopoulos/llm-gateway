<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LLM Gateway Admin Panel</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div class="bg-grid" aria-hidden="true"></div>
    <header class="site-header">
      <div class="brand">
        <div class="brand-mark">LG</div>
        <div class="brand-text">
          <div class="brand-title">Admin Panel</div>
          <div class="brand-subtitle">Keys, lifecycle, and governance</div>
        </div>
      </div>
      <nav class="site-nav" aria-label="Primary">
        <a href="/">Overview</a>
        <a class="active" href="/admin">Admin</a>
        <a href="/tenants">Tenants</a>
        <a href="/keys">API Keys</a>
        <a href="/chat">Chat</a>
      </nav>
      <div class="env-pill" id="env-pill">Disconnected</div>
    </header>

    <main class="layout">
      <section class="panel hero">
        <div class="hero-top">
          <div>
            <div class="eyebrow">Admin Controls</div>
            <h2>Privileged Operational Surface</h2>
          </div>
          <div class="pill">Admin only</div>
        </div>
        <p class="muted">
          Manage tenant lifecycle, issue and revoke keys, and rotate admin credentials. Actions
          here should be audited and treated as privileged.
        </p>
      </section>

      <section class="panel">
        <h2>Admin Session</h2>
        <p class="muted">
          Use the admin key to unlock tenant operations. Stored locally in your browser only.
        </p>
        <label class="field">
          <span>Gateway Base URL</span>
          <input id="base-url" type="text" placeholder="http://localhost:8000" />
        </label>
        <label class="field">
          <span>Admin API Key</span>
          <input id="admin-key" type="password" placeholder="sk-admin-..." />
        </label>
        <div class="row">
          <button class="primary" id="save-settings">Save &amp; Check</button>
          <button class="ghost" id="clear-settings">Clear</button>
        </div>
        <div class="status" id="session-status"></div>
        <div class="health-inline" id="health-inline">
          <span class="health-chip" id="health-chip">Status: --</span>
        </div>
        <div class="callout">
          Key hygiene: rotate admin keys periodically. Never paste production keys into shared browsers.
        </div>
      </section>

      <section class="panel">
        <h2>Key Rotation &amp; Revocation</h2>
        <p class="muted">Rotate the admin key and track privileged access.</p>
        <div class="stack">
          <div class="stack-block">
            <div class="stack-title">Rotate Admin Key</div>
            <p class="muted">
              Generates a new admin key and deactivates existing admin keys. Update
              <span class="mono">ADMIN_API_KEY</span> and restart to persist.
            </p>
            <div class="row">
              <button class="primary" id="rotate-admin">Rotate Admin Key</button>
              <button class="ghost" id="copy-admin" disabled>Copy New</button>
            </div>
            <div class="key-card">
              <div class="key-title">New Admin Key</div>
              <div class="key-value" id="admin-key-value">No rotation yet.</div>
            </div>
          </div>
        </div>
      </section>

      <section class="panel">
        <h2>RAG Controls</h2>
        <p class="muted">Toggle retrieval, adjust context limits, and reranking.</p>
        <div class="grid-2">
          <label class="field">
            <span>RAG Enabled</span>
            <input id="rag-enabled" type="checkbox" />
          </label>
          <label class="field">
            <span>Top K</span>
            <input id="rag-topk" type="number" min="1" max="20" value="4" />
          </label>
          <label class="field">
            <span>Max Context Chars</span>
            <input id="rag-max-context" type="number" min="200" max="20000" value="4000" />
          </label>
          <label class="field">
            <span>Rerank</span>
            <input id="rag-rerank" type="checkbox" checked />
          </label>
        </div>
        <div class="row">
          <button class="ghost" id="rag-load">Load Settings</button>
          <button class="primary" id="rag-save">Save Settings</button>
        </div>
        <div class="status" id="rag-status"></div>
      </section>

      <section class="panel">
        <h2>RAG Ingestion</h2>
        <p class="muted">Upload text content to the vector store.</p>
        <div class="grid-2">
          <label class="field">
            <span>Tenant</span>
            <select id="rag-tenant"></select>
          </label>
          <label class="field">
            <span>Source</span>
            <input id="rag-source" type="text" value="ui" />
          </label>
          <label class="field">
            <span>Source ID</span>
            <input id="rag-source-id" type="text" placeholder="optional" />
          </label>
          <label class="field">
            <span>Title</span>
            <input id="rag-title" type="text" placeholder="optional" />
          </label>
          <label class="field">
            <span>Chunk Size</span>
            <input id="rag-chunk-size" type="number" min="200" max="5000" value="1000" />
          </label>
          <label class="field">
            <span>Overlap</span>
            <input id="rag-overlap" type="number" min="0" max="1000" value="200" />
          </label>
        </div>
        <label class="field">
          <span>Content</span>
          <textarea id="rag-content" rows="6" placeholder="Paste document text here..."></textarea>
        </label>
        <div class="row">
          <button class="primary" id="rag-ingest">Ingest Document</button>
        </div>
        <div class="status" id="rag-ingest-status"></div>
      </section>

      <section class="panel">
        <h2>Eval Runner</h2>
        <p class="muted">Run offline eval checks and validate thresholds.</p>
        <div class="grid-2">
          <label class="field">
            <span>Dataset Path</span>
            <input id="eval-dataset" type="text" value="evals/dataset.jsonl" />
          </label>
          <label class="field">
            <span>Min Accuracy</span>
            <input id="eval-min-accuracy" type="number" min="0" max="1" step="0.01" value="0.6" />
          </label>
          <label class="field">
            <span>Max P95 Latency (ms)</span>
            <input id="eval-max-p95" type="number" min="100" max="60000" value="2000" />
          </label>
          <label class="field">
            <span>Max Avg Cost (USD)</span>
            <input id="eval-max-cost" type="number" min="0" max="1" step="0.001" value="0.01" />
          </label>
        </div>
        <div class="row">
          <button class="primary" id="eval-run">Run Evals</button>
        </div>
        <div class="status" id="eval-status"></div>
        <pre class="mono" id="eval-output"></pre>
      </section>

      <section class="panel">
        <h2>Audit Log</h2>
        <p class="muted">Recent privileged actions for traceability.</p>
        <div class="row">
          <button class="ghost" id="load-audit">Refresh Audit Log</button>
        </div>
        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th>Time</th>
                <th>Actor</th>
                <th>Action</th>
                <th>Target</th>
                <th>Metadata</th>
              </tr>
            </thead>
            <tbody id="audit-body"></tbody>
          </table>
        </div>
        <div class="status" id="audit-status"></div>
      </section>
    </main>

    <footer class="site-footer">
      <div>LLM Gateway - Admin Console</div>
      <div>Designed as a senior AI systems portfolio artifact.</div>
    </footer>

    <script src="/static/shared.js"></script>
    <script src="/static/admin.js"></script>
  </body>
</html>
